<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lagos Transit Pro - Smart Public Transportation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        .glassmorphism {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .dark .glassmorphism {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .logo-animation {
            animation: logoFloat 3s ease-in-out infinite;
        }
        
        @keyframes logoFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .slide-in {
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .bus-animation {
            animation: busMove 3s ease-in-out infinite;
        }
        
        @keyframes busMove {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(10px); }
        }
        
        .ticket-used {
            opacity: 0.6;
            background: linear-gradient(45deg, transparent 25%, rgba(239, 68, 68, 0.1) 25%, rgba(239, 68, 68, 0.1) 50%, transparent 50%, transparent 75%, rgba(239, 68, 68, 0.1) 75%);
            background-size: 20px 20px;
        }
        
        .loading-spinner {
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
    <script>
function openPaymentModal() {
    document.getElementById('paymentModal').classList.remove('hidden');
}
function closePaymentModal() {
    document.getElementById('paymentModal').classList.add('hidden');
}
document.getElementById('paymentForm').addEventListener('submit', function(e) {
    e.preventDefault();
    closePaymentModal();
    showAlert("Payment successful! Your ticket is being processed.");
});
document.querySelectorAll('.popular-route').forEach(function(routeCard) {
    routeCard.addEventListener('click', function() {
        openPaymentModal();
    });
});
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'inter': ['Inter', 'sans-serif'],
                    },
                    colors: {
                        primary: '#5D5CDE',
                        secondary: '#A855F7',
                    }
                }
            }
        }
    </script>
</head>
<body class="font-inter bg-white dark:bg-gray-900 transition-colors duration-300">
    
    <!-- Welcome Screen -->
    <div id="welcomeScreen" class="min-h-screen flex flex-col items-center justify-center px-4 bg-gradient-to-br from-primary to-secondary">
        <div class="text-center text-white">
            <div class="logo-animation mb-8">
                <div class="w-32 h-32 bg-white rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-2xl">
                    <svg class="w-16 h-16 text-primary" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"/>
                        <path d="M3 4a1 1 0 00-1 1v10a1 1 0 001 1h1.05a2.5 2.5 0 014.9 0H10a1 1 0 001-1V5a1 1 0 00-1-1H3zM14 7a1 1 0 00-1 1v6.05A2.5 2.5 0 0115.95 16H17a1 1 0 001-1V8a1 1 0 00-1-1h-3z"/>
                    </svg>
                </div>
                <h1 class="text-4xl font-bold mb-4">Lagos Transit Pro</h1>
            </div>
            
            <div class="max-w-md mx-auto mb-12">
                <h2 class="text-xl font-semibold mb-4">Smart Transportation for Lagos</h2>
                <p class="text-lg opacity-90 leading-relaxed">
                    Revolutionizing public transportation in Lagos State through technology. 
                    Real-time tracking, easy booking, and seamless navigation for a better commute experience.
                </p>
            </div>
            
            <div class="space-y-4 max-w-sm mx-auto">
                <div class="bg-white bg-opacity-20 backdrop-blur rounded-2xl p-4">
                    <div class="flex items-center justify-center mb-2">
                        <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span class="font-semibold">Reduce Traffic Congestion</span>
                    </div>
                </div>
                
                <div class="bg-white bg-opacity-20 backdrop-blur rounded-2xl p-4">
                    <div class="flex items-center justify-center mb-2">
                        <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span class="font-semibold">Save Commute Time</span>
                    </div>
                </div>
                
                <div class="bg-white bg-opacity-20 backdrop-blur rounded-2xl p-4">
                    <div class="flex items-center justify-center mb-2">
                        <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8.433 7.418c.155-.103.346-.196.567-.267v1.698a2.305 2.305 0 01-.567-.267C8.07 8.34 8 8.114 8 8c0-.114.07-.34.433-.582zM11 12.849v-1.698c.22.071.412.164.567.267.364.243.433.468.433.582 0 .114-.07.34-.433.582a2.305 2.305 0 01-.567.267z"/>
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.676.662C6.602 6.234 6 7.009 6 8c0 .99.602 1.765 1.324 2.246.48.32 1.054.545 1.676.662v1.941c-.391-.127-.68-.317-.843-.504a1 1 0 10-1.51 1.31c.562.649 1.413 1.076 2.353 1.253V15a1 1 0 102 0v-.092a4.535 4.535 0 001.676-.662C13.398 13.766 14 12.991 14 12c0-.99-.602-1.765-1.324-2.246A4.535 4.535 0 0011 9.092V7.151c.391.127.68.317.843.504a1 1 0 101.511-1.31c-.563-.649-1.413-1.076-2.354-1.253V5z" clip-rule="evenodd"/>
                        </svg>
                        <span class="font-semibold">Affordable & Accessible</span>
                    </div>
                </div>
            </div>
            
            <button id="getStartedBtn" class="mt-12 bg-white text-primary font-bold py-4 px-8 rounded-2xl text-lg hover:bg-gray-100 transition-colors shadow-lg">
                Get Started
            </button>
            
            <div class="mt-8 text-sm opacity-75">
                Empowering Lagos commuters since 2024
            </div>
        </div>
    </div>

    <!-- Authentication Screen -->
    <div id="authScreen" class="min-h-screen flex flex-col items-center justify-center px-4 bg-gray-50 dark:bg-gray-900 hidden">
        <div class="w-full max-w-md">
            <div class="text-center mb-8">
                <div class="w-20 h-20 bg-primary rounded-2xl flex items-center justify-center mx-auto mb-4">
                    <svg class="w-10 h-10 text-white" fill="currentColor" viewBox="0 0 20 20">
                        <path d="M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"/>
                        <path d="M3 4a1 1 0 00-1 1v10a1 1 0 001 1h1.05a2.5 2.5 0 014.9 0H10a1 1 0 001-1V5a1 1 0 00-1-1H3zM14 7a1 1 0 00-1 1v6.05A2.5 2.5 0 0115.95 16H17a1 1 0 001-1V8a1 1 0 00-1-1h-3z"/>
                    </svg>
                </div>
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">Welcome Back</h2>
                <p class="text-gray-600 dark:text-gray-400">Sign in to continue your journey</p>
            </div>

            <div class="bg-white dark:bg-gray-800 rounded-3xl p-8 shadow-xl">
                <!-- Auth Toggle -->
                <div class="flex mb-6 bg-gray-100 dark:bg-gray-700 rounded-2xl p-1">
                    <button id="signInTab" class="flex-1 py-2 px-4 rounded-xl text-sm font-semibold transition-all bg-white dark:bg-gray-600 text-primary shadow-sm">
                        Sign In
                    </button>
                    <button id="signUpTab" class="flex-1 py-2 px-4 rounded-xl text-sm font-semibold transition-all text-gray-600 dark:text-gray-400">
                        Sign Up
                    </button>
                </div>

                <!-- Google Sign In -->
                <button id="googleSignIn" class="w-full flex items-center justify-center px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-2xl shadow-sm bg-white dark:bg-gray-700 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors mb-4">
                    <svg class="w-5 h-5 mr-3" viewBox="0 0 24 24">
                        <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                    Continue with Google
                </button>

                <div class="relative my-6">
                    <div class="absolute inset-0 flex items-center">
                        <div class="w-full border-t border-gray-300 dark:border-gray-600"></div>
                    </div>
                    <div class="relative flex justify-center text-sm">
                        <span class="px-2 bg-white dark:bg-gray-800 text-gray-500">Or continue with</span>
                    </div>
                </div>

                <!-- Email Form -->
                <form id="authForm" class="space-y-4">
                    <div id="nameField" class="hidden">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Full Name</label>
                        <input type="text" id="fullName" class="w-full px-3 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-2xl focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="Enter your full name">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Email</label>
                        <input type="email" id="email" class="w-full px-3 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-2xl focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="Enter your email" required>
                    </div>
                    
                    <div id="phoneField" class="hidden">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Phone Number</label>
                        <input type="tel" id="phone" class="w-full px-3 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-2xl focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="+234 xxx xxx xxxx">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Password</label>
                        <input type="password" id="password" class="w-full px-3 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-2xl focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="Enter your password" required>
                    </div>
                    
                    <div id="confirmPasswordField" class="hidden">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Confirm Password</label>
                        <input type="password" id="confirmPassword" class="w-full px-3 py-3 text-base border border-gray-300 dark:border-gray-600 rounded-2xl focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="Confirm your password">
                    </div>
                    
                    <button type="submit" id="authSubmitBtn" class="w-full bg-primary hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-2xl transition-colors">
                        Sign In
                    </button>
                </form>

                <div class="mt-6 text-center">
                    <a href="#" class="text-sm text-primary hover:text-blue-700">Forgot your password?</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="mainApp" class="hidden">
        <!-- Navigation -->
        <nav class="glassmorphism fixed top-0 left-0 right-0 z-50 px-4 py-3">
            <div class="flex items-center justify-between max-w-7xl mx-auto">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-primary rounded-lg flex items-center justify-center">
                        <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"/>
                            <path d="M3 4a1 1 0 00-1 1v10a1 1 0 001 1h1.05a2.5 2.5 0 014.9 0H10a1 1 0 001-1V5a1 1 0 00-1-1H3zM14 7a1 1 0 00-1 1v6.05A2.5 2.5 0 0115.95 16H17a1 1 0 001-1V8a1 1 0 00-1-1h-3z"/>
                        </svg>
                    </div>
                    <span class="text-xl font-bold text-gray-900 dark:text-white">Lagos Transit Pro</span>
                </div>
                <div class="flex items-center space-x-3">
                    <div id="userInfo" class="flex items-center space-x-2">
                        <img id="userAvatar" src="" alt="User" class="w-8 h-8 rounded-full border-2 border-white shadow-sm hidden">
                        <span id="userName" class="text-sm font-medium text-gray-700 dark:text-gray-300 hidden"></span>
                    </div>
                    <button id="profileMenuBtn" class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800">
                        <svg class="w-6 h-6 text-gray-700 dark:text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </nav>

        <!-- Profile Menu Dropdown -->
        <div id="profileMenu" class="fixed top-16 right-4 w-64 glassmorphism rounded-2xl shadow-xl z-50 hidden">
            <div class="p-4">
                <div class="flex items-center space-x-3 mb-4 pb-4 border-b border-gray-200 dark:border-gray-600">
                    <img id="profileAvatar" src="" alt="Profile" class="w-12 h-12 rounded-full border-2 border-primary">
                    <div>
                        <div id="profileName" class="font-semibold text-gray-900 dark:text-white"></div>
                        <div id="profileEmail" class="text-sm text-gray-600 dark:text-gray-400"></div>
                    </div>
                </div>
                
                <div class="space-y-2">
                    <button class="profile-menu-item w-full flex items-center space-x-3 px-3 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" data-action="viewProfile">
                        <svg class="w-5 h-5 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                        </svg>
                        <span class="text-gray-700 dark:text-gray-300">View Profile</span>
                    </button>
                    
                    <button class="profile-menu-item w-full flex items-center space-x-3 px-3 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" data-action="myTickets">
                        <svg class="w-5 h-5 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 11-0-4V7a2 2 0 00-2-2H5z"/>
                        </svg>
                        <span class="text-gray-700 dark:text-gray-300">My Tickets</span>
                    </button>
                    
                    <button class="profile-menu-item w-full flex items-center space-x-3 px-3 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" data-action="tripHistory">
                        <svg class="w-5 h-5 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <span class="text-gray-700 dark:text-gray-300">Trip History</span>
                    </button>

                    <button class="profile-menu-item w-full flex items-center space-x-3 px-3 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" data-action="paymentMethods">
                        <svg class="w-5 h-5 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a5 5 0 00-10 0v2a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 19a2 2 0 004 0"/>
                        </svg>
                        <span class="text-gray-700 dark:text-gray-300">Payment Methods</span>
                    </button>

                    <button class="profile-menu-item w-full flex items-center space-x-3 px-3 py-2 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors" data-action="preferences">
                        <svg class="w-5 h-5 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                        <span class="text-gray-700 dark:text-gray-300">Preferences</span>
                    </button>
                    
                    <hr class="border-gray-200 dark:border-gray-600 my-2">
                    
                    <button class="profile-menu-item w-full flex items-center space-x-3 px-3 py-2 rounded-xl hover:bg-red-100 dark:hover:bg-red-900 transition-colors text-red-600 dark:text-red-400" data-action="signOut">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                        </svg>
                        <span>Sign Out</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="pt-20 pb-20">
            <!-- Home Screen -->
            <div id="homeScreen" class="px-4 max-w-7xl mx-auto">
                <!-- Welcome Message -->
                <div class="glassmorphism rounded-3xl p-6 mb-6">
                    <h1 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">Welcome back!</h1>
                    <p class="text-gray-600 dark:text-gray-400">Plan your journey and track buses in real-time</p>
                </div>

                <!-- Quick Stats -->
                <div class="grid grid-cols-3 gap-4 mb-8">
                    <div class="glassmorphism rounded-2xl p-4">
                        <div class="text-2xl font-bold text-primary">150+</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">Active Buses</div>
                    </div>
                    <div class="glassmorphism rounded-2xl p-4">
                        <div class="text-2xl font-bold text-secondary">45</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">Routes</div>
                    </div>
                    <div class="glassmorphism rounded-2xl p-4">
                        <div class="text-2xl font-bold text-green-500">98%</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">On Time</div>
                    </div>
                </div>

                <!-- Route Planner -->
                <div class="glassmorphism rounded-3xl p-6 mb-8">
                    <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Plan Your Journey</h2>
                    
                    <div class="space-y-4">
                        <div class="relative">
                            <input type="text" id="fromLocation" placeholder="From (e.g., Victoria Island)" 
                                   class="w-full px-4 py-3 text-base rounded-2xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent">
                            <div class="absolute left-3 top-3">
                                <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                            </div>
                        </div>
                        
                        <div class="flex justify-center">
                            <button id="swapLocations" class="p-2 rounded-full bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600">
                                <svg class="w-5 h-5 text-gray-600 dark:text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"/>
                                </svg>
                            </button>
                        </div>
                        
                        <div class="relative">
                            <input type="text" id="toLocation" placeholder="To (e.g., Ikeja)" 
                                   class="w-full px-4 py-3 text-base rounded-2xl border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:border-transparent">
                            <div class="absolute left-3 top-3">
                                <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                            </div>
                        </div>
                        
                        <button id="findRoutesBtn" class="w-full bg-primary hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-2xl transition-colors">
                            Find Routes
                        </button>
                    </div>
                </div>

                <!-- Popular Routes -->
                <div class="mb-8">
                    <h2 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">Popular Routes</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="popular-route glassmorphism rounded-2xl p-4 cursor-pointer hover:scale-105 transition-transform" 
                             data-from="Victoria Island" data-to="Ikeja">
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-semibold text-gray-900 dark:text-white">Victoria Island ‚Üí Ikeja</span>
                                <span class="text-primary font-bold">‚Ç¶500</span>
                            </div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">45 min ‚Ä¢ 5 buses available</div>
                        </div>
                        
                        <div class="popular-route glassmorphism rounded-2xl p-4 cursor-pointer hover:scale-105 transition-transform"
                             data-from="Surulere" data-to="Lekki">
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-semibold text-gray-900 dark:text-white">Surulere ‚Üí Lekki</span>
                                <span class="text-primary font-bold">‚Ç¶600</span>
                            </div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">52 min ‚Ä¢ 3 buses available</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Maps Screen -->
            <div id="mapsScreen" class="px-4 max-w-7xl mx-auto hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">Live Bus Tracking</h2>
                    <p class="text-gray-600 dark:text-gray-400">Real-time locations of all active buses</p>
                </div>

                <div class="glassmorphism rounded-3xl p-6 mb-6">
                    <div id="mapContainer" class="w-full h-96 bg-gray-200 dark:bg-gray-700 rounded-2xl mb-4 flex items-center justify-center">
                        <div class="text-center">
                            <div class="text-6xl mb-4">üó∫Ô∏è</div>
                            <p class="text-gray-600 dark:text-gray-400 font-semibold">Interactive Google Maps</p>
                            <p class="text-sm text-gray-500 dark:text-gray-500 mt-2">Real-time bus locations and routes</p>
                            <button id="openGoogleMaps" class="mt-4 bg-primary hover:bg-blue-700 text-white px-6 py-3 rounded-2xl transition-colors">
                                Open Google Maps
                            </button>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div class="text-center p-4 bg-green-100 dark:bg-green-900 rounded-2xl">
                            <div class="text-2xl font-bold text-green-600 dark:text-green-400">142</div>
                            <div class="text-sm text-green-600 dark:text-green-400">Buses Online</div>
                        </div>
                        <div class="text-center p-4 bg-blue-100 dark:bg-blue-900 rounded-2xl">
                            <div class="text-2xl font-bold text-blue-600 dark:text-blue-400">8</div>
                            <div class="text-sm text-blue-600 dark:text-blue-400">Routes Active</div>
                        </div>
                    </div>
                </div>

                <div class="space-y-4">
                    <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Active Routes</h3>
                    <div id="activeRoutesList" class="space-y-3">
                        <!-- Active routes will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Tickets Screen -->
            <div id="ticketsScreen" class="px-4 max-w-7xl mx-auto hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 dark:text-white">My Tickets</h2>
                    <p class="text-gray-600 dark:text-gray-400">Manage your current and past bookings</p>
                </div>

                <!-- Ticket Stats -->
                <div class="grid grid-cols-3 gap-4 mb-6">
                    <div class="glassmorphism rounded-2xl p-4 text-center">
                        <div class="text-2xl font-bold text-blue-500" id="activeTicketsCount">2</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">Active</div>
                    </div>
                    <div class="glassmorphism rounded-2xl p-4 text-center">
                        <div class="text-2xl font-bold text-green-500" id="usedTicketsCount">15</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">Used</div>
                    </div>
                    <div class="glassmorphism rounded-2xl p-4 text-center">
                        <div class="text-2xl font-bold text-gray-500" id="totalTicketsCount">17</div>
                        <div class="text-sm text-gray-600 dark:text-gray-400">Total</div>
                    </div>
                </div>

                <!-- Filter Tabs -->
                <div class="flex mb-6 bg-gray-100 dark:bg-gray-700 rounded-2xl p-1">
                    <button class="ticket-filter flex-1 py-2 px-4 rounded-xl text-sm font-semibold transition-all bg-white dark:bg-gray-600 text-primary shadow-sm" data-filter="all">
                        All Tickets
                    </button>
                    <button class="ticket-filter flex-1 py-2 px-4 rounded-xl text-sm font-semibold transition-all text-gray-600 dark:text-gray-400" data-filter="active">
                        Active
                    </button>
                    <button class="ticket-filter flex-1 py-2 px-4 rounded-xl text-sm font-semibold transition-all text-gray-600 dark:text-gray-400" data-filter="used">
                        Used
                    </button>
                </div>

                <!-- Tickets List -->
                <div id="ticketsList" class="space-y-4">
                    <!-- Tickets will be populated here -->
                </div>
            </div>

            <!-- Profile Screen -->
            <div id="profileScreen" class="px-4 max-w-7xl mx-auto hidden">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Profile</h2>
                    <p class="text-gray-600 dark:text-gray-400">Manage your account and preferences</p>
                </div>

                <div class="space-y-6">
                    <!-- Profile Info -->
                    <div class="glassmorphism rounded-3xl p-6">
                        <div class="flex items-center space-x-4 mb-6">
                            <img id="profilePicture" src="" alt="Profile" class="w-20 h-20 rounded-full border-4 border-primary">
                            <div>
                                <h3 id="profileDisplayName" class="text-xl font-bold text-gray-900 dark:text-white"></h3>
                                <p id="profileDisplayEmail" class="text-gray-600 dark:text-gray-400"></p>
                                <p id="profileDisplayPhone" class="text-gray-600 dark:text-gray-400"></p>
                            </div>
                        </div>
                        
                        <button id="editProfileBtn" class="w-full bg-primary hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-2xl transition-colors">
                            Edit Profile
                        </button>
                    </div>

<div id="paymentsScreen" class="px-4 max-w-7xl mx-auto hidden">
  <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">Payment Methods & History</h2>
  <!-- Add your payment history/content here -->
</div>

                    <!-- Trip Statistics -->
                    <div class="glassmorphism rounded-3xl p-6">
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Trip Statistics</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="text-center p-4 bg-blue-100 dark:bg-blue-900 rounded-2xl">
                                <div class="text-2xl font-bold text-blue-600 dark:text-blue-400">23</div>
                                <div class="text-sm text-blue-600 dark:text-blue-400">Total Trips</div>
                            </div>
                            <div class="text-center p-4 bg-green-100 dark:bg-green-900 rounded-2xl">
                                <div class="text-2xl font-bold text-green-600 dark:text-green-400">‚Ç¶12,500</div>
                                <div class="text-sm text-green-600 dark:text-green-400">Total Spent</div>
                            </div>
                            <div class="text-center p-4 bg-purple-100 dark:bg-purple-900 rounded-2xl">
                                <div class="text-2xl font-bold text-purple-600 dark:text-purple-400">156</div>
                                <div class="text-sm text-purple-600 dark:text-purple-400">Hours Saved</div>
                            </div>
                            <div class="text-center p-4 bg-yellow-100 dark:bg-yellow-900 rounded-2xl">
                                <div class="text-2xl font-bold text-yellow-600 dark:text-yellow-400">4.8‚òÖ</div>
                                <div class="text-sm text-yellow-600 dark:text-yellow-400">Avg Rating</div>
                            </div>
                        </div>
                    </div>

                    <!-- Preferences -->
                    <div class="glassmorphism rounded-3xl p-6">
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Preferences</h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <span class="text-gray-700 dark:text-gray-300">Push Notifications</span>
                                <button class="toggle-switch bg-primary w-12 h-6 rounded-full relative">
                                    <div class="toggle-dot w-5 h-5 bg-white rounded-full absolute top-0.5 right-0.5 transition-transform"></div>
                                </button>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-gray-700 dark:text-gray-300">Location Services</span>
                                <button class="toggle-switch bg-primary w-12 h-6 rounded-full relative">
                                    <div class="toggle-dot w-5 h-5 bg-white rounded-full absolute top-0.5 right-0.5 transition-transform"></div>
                                </button>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-gray-700 dark:text-gray-300">Email Updates</span>
                                <button class="toggle-switch bg-gray-300 dark:bg-gray-600 w-12 h-6 rounded-full relative">
                                    <div class="toggle-dot w-5 h-5 bg-white rounded-full absolute top-0.5 left-0.5 transition-transform"></div>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Other screens (booking, payment, etc.) will be added here -->
        </main>

        <!-- Bottom Navigation -->
        <nav class="fixed bottom-0 left-0 right-0 glassmorphism border-t border-gray-200 dark:border-gray-700">
            <div class="grid grid-cols-4 max-w-7xl mx-auto">
                <button class="nav-item active flex flex-col items-center py-3 px-2" data-screen="home">
                    <svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                    </svg>
                    <span class="text-xs">Home</span>
                </button>
                <button class="nav-item flex flex-col items-center py-3 px-2" data-screen="maps">
                    <svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"/>
                    </svg>
                    <span class="text-xs">Maps</span>
                </button>
                <button class="nav-item flex flex-col items-center py-3 px-2" data-screen="tickets">
                    <svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 11-0-4V7a2 2 0 00-2-2H5z"/>
                    </svg>
                    <span class="text-xs">Tickets</span>
                </button>
                <button class="nav-item flex flex-col items-center py-3 px-2" data-screen="profile">
                    <svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                    </svg>
                    <span class="text-xs">Profile</span>
                </button>
                <button class="nav-item flex flex-col items-center py-3 px-2" data-screen="paymentsScreen">
                    <svg class="w-6 h-6 mb-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a5 5 0 00-10 0v2a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 19a2 2 0 004 0"/>
                   </svg>
                   <span class="text-xs">Payments</span>
               </button>
            </div>
        </nav>
    </div>

    <script>
        // Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // App State
        let appState = {
            currentUser: null,
            isAuthenticated: false,
            currentScreen: 'welcome',
            userTickets: [],
            tripHistory: []
        };

        // Mock user data
        const mockUsers = {
            'user@example.com': {
                id: '1',
                name: 'John Doe',
                email: 'user@example.com',
                phone: '+234 803 123 4567',
                avatar: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face',
                preferences: {
                    notifications: true,
                    location: true,
                    emailUpdates: false
                },
                tickets: [
                    {
                        id: 'TKT-ABC123',
                        busId: 'LT-2301',
                        route: 'Victoria Island ‚Üí Ikeja',
                        date: '2024-01-15',
                        time: '08:30 AM',
                        seats: 1,
                        price: 500,
                        status: 'active',
                        qrCode: 'QR123456'
                    },
                    {
                        id: 'TKT-DEF456',
                        busId: 'LT-1845',
                        route: 'Surulere ‚Üí Lekki',
                        date: '2024-01-14',
                        time: '07:45 AM',
                        seats: 2,
                        price: 1200,
                        status: 'used',
                        qrCode: 'QR789012'
                    }
                ]
            }
        };

        // Screen Management
        function showScreen(screenId) {
            // Hide all main screens
            const screens = ['homeScreen', 'mapsScreen', 'ticketsScreen', 'profileScreen'];
            screens.forEach(screen => {
                const element = document.getElementById(screen);
                if (element) element.classList.add('hidden');
            });
            
            // Show target screen
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.remove('hidden');
                targetScreen.classList.add('fade-in');
            }
            
            // Update nav active state
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active', 'text-primary');
                item.classList.add('text-gray-600', 'dark:text-gray-400');
            });
            
            // Set active nav item
            const navMap = {
                'homeScreen': 'home',
                'mapsScreen': 'maps', 
                'ticketsScreen': 'tickets',
                'profileScreen': 'profile'
            };
            
            const navItem = document.querySelector(`[data-screen="${navMap[screenId]}"]`);
            if (navItem) {
                navItem.classList.add('active', 'text-primary');
                navItem.classList.remove('text-gray-600', 'dark:text-gray-400');
            }
            
            appState.currentScreen = screenId;
        }

        function showWelcomeScreen() {
            document.getElementById('welcomeScreen').classList.remove('hidden');
            document.getElementById('authScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.add('hidden');
        }

        function showAuthScreen() {
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('authScreen').classList.remove('hidden');
            document.getElementById('mainApp').classList.add('hidden');
        }

        function showMainApp() {
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('authScreen').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
            showScreen('homeScreen');
        }

        // Custom Modal Functions
        function showAlert(message) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <div class="text-center">
                        <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-6 h-6 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <p class="text-gray-700 dark:text-gray-300 mb-4">${message}</p>
                        <button class="px-4 py-2 bg-primary text-white hover:bg-blue-700 rounded-lg" onclick="this.closest('.fixed').remove()">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function showConfirmDialog(message, onConfirm) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <div class="text-center">
                        <div class="w-12 h-12 bg-yellow-100 dark:bg-yellow-900 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-6 h-6 text-yellow-600 dark:text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"/>
                            </svg>
                        </div>
                        <p class="text-gray-700 dark:text-gray-300 mb-6">${message}</p>
                        <div class="flex justify-center space-x-3">
                            <button class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg" onclick="this.closest('.fixed').remove()">Cancel</button>
                            <button class="px-4 py-2 bg-primary text-white hover:bg-blue-700 rounded-lg" onclick="this.closest('.fixed').remove(); (${onConfirm})()">Confirm</button>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Authentication Functions
        function handleGoogleSignIn() {
            // Simulate Google sign in
            const mockGoogleUser = {
                id: 'google_123',
                name: 'John Doe',
                email: 'john.doe@gmail.com',
                phone: '+234 803 123 4567',
                avatar: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face',
                provider: 'google'
            };
            
            mockUsers[mockGoogleUser.email] = {
                ...mockGoogleUser,
                preferences: {
                    notifications: true,
                    location: true,
                    emailUpdates: true
                },
                tickets: []
            };
            
            signInUser(mockGoogleUser);
        }

        function handleEmailAuth(isSignUp) {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const fullName = document.getElementById('fullName').value;
            const phone = document.getElementById('phone').value;
            
            if (!email || !password) {
                showAlert('Please fill in all required fields');
                return;
            }
            
            if (isSignUp) {
                if (!fullName) {
                    showAlert('Please enter your full name');
                    return;
                }
                
                if (mockUsers[email]) {
                    showAlert('An account with this email already exists');
                    return;
                }
                
                // Create new user
                const newUser = {
                    id: Date.now().toString(),
                    name: fullName,
                    email: email,
                    phone: phone || '',
                    avatar: `https://ui-avatars.com/api/?name=${encodeURIComponent(fullName)}&background=5D5CDE&color=fff&size=150`,
                    provider: 'email'
                };
                
                mockUsers[email] = {
                    ...newUser,
                    preferences: {
                        notifications: true,
                        location: true,
                        emailUpdates: true
                    },
                    tickets: []
                };
                
                signInUser(newUser);
            } else {
                // Sign in existing user
                if (!mockUsers[email]) {
                    showAlert('Account not found. Please sign up first.');
                    return;
                }
                
                signInUser(mockUsers[email]);
            }
        }

        function signInUser(user) {
            appState.currentUser = user;
            appState.isAuthenticated = true;
            appState.userTickets = mockUsers[user.email]?.tickets || [];
            
            updateUserUI(user);
            showMainApp();
        }

        function updateUserUI(user) {
            // Update nav bar user info
            document.getElementById('userAvatar').src = user.avatar;
            document.getElementById('userAvatar').classList.remove('hidden');
            document.getElementById('userName').textContent = user.name.split(' ')[0];
            document.getElementById('userName').classList.remove('hidden');
            
            // Update profile menu
            document.getElementById('profileAvatar').src = user.avatar;
            document.getElementById('profileName').textContent = user.name;
            document.getElementById('profileEmail').textContent = user.email;
            
            // Update profile screen
            document.getElementById('profilePicture').src = user.avatar;
            document.getElementById('profileDisplayName').textContent = user.name;
            document.getElementById('profileDisplayEmail').textContent = user.email;
            document.getElementById('profileDisplayPhone').textContent = user.phone || 'Not provided';
            
            // Load user tickets
            loadUserTickets();
        }

        function signOut() {
            appState.currentUser = null;
            appState.isAuthenticated = false;
            appState.userTickets = [];
            
            // Reset UI
            document.getElementById('userAvatar').classList.add('hidden');
            document.getElementById('userName').classList.add('hidden');
            
            showAuthScreen();
        }

        // Tickets Management
        function loadUserTickets() {
            const ticketsList = document.getElementById('ticketsList');
            const tickets = appState.userTickets;
            
            if (tickets.length === 0) {
                ticketsList.innerHTML = `
                    <div class="text-center py-12">
                        <div class="text-6xl mb-4">üé´</div>
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">No tickets yet</h3>
                        <p class="text-gray-600 dark:text-gray-400">Book your first trip to get started!</p>
                    </div>
                `;
                return;
            }
            
            ticketsList.innerHTML = '';
            tickets.forEach(ticket => {
                const ticketCard = createTicketCard(ticket);
                ticketsList.appendChild(ticketCard);
            });
            
            updateTicketStats(tickets);
        }

        function createTicketCard(ticket) {
            const card = document.createElement('div');
            card.className = `glassmorphism rounded-2xl p-6 ${ticket.status === 'used' ? 'ticket-used' : ''}`;
            
            const statusColor = ticket.status === 'active' ? 'bg-green-500' : 'bg-gray-500';
            const statusText = ticket.status === 'active' ? 'Active' : 'Used';
            
            card.innerHTML = `
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-primary rounded-xl flex items-center justify-center mr-4">
                            <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"/>
                                <path d="M3 4a1 1 0 00-1 1v10a1 1 0 001 1h1.05a2.5 2.5 0 014.9 0H10a1 1 0 001-1V5a1 1 0 00-1-1H3zM14 7a1 1 0 00-1 1v6.05A2.5 2.5 0 0115.95 16H17a1 1 0 001-1V8a1 1 0 00-1-1h-3z"/>
                            </svg>
                        </div>
                        <div>
                            <div class="font-bold text-gray-900 dark:text-white">${ticket.id}</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">Bus #${ticket.busId}</div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-lg font-bold text-primary">‚Ç¶${ticket.price.toLocaleString()}</div>
                        <div class="text-xs px-2 py-1 rounded-full text-white ${statusColor}">${statusText}</div>
                    </div>
                </div>
                
                <div class="space-y-2 mb-4">
                    <div class="flex justify-between">
                        <span class="text-gray-600 dark:text-gray-400">Route:</span>
                        <span class="font-semibold text-gray-900 dark:text-white">${ticket.route}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600 dark:text-gray-400">Date:</span>
                        <span class="text-gray-900 dark:text-white">${ticket.date}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600 dark:text-gray-400">Time:</span>
                        <span class="text-gray-900 dark:text-white">${ticket.time}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="text-gray-600 dark:text-gray-400">Seats:</span>
                        <span class="text-gray-900 dark:text-white">${ticket.seats}</span>
                    </div>
                </div>
                
                ${ticket.status === 'active' ? `
                    <div class="flex space-x-3">
                        <button class="flex-1 bg-primary hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition-colors" onclick="trackTicket('${ticket.id}')">
                            Track Bus
                        </button>
                        <button class="flex-1 border border-primary text-primary hover:bg-primary hover:text-white py-2 px-4 rounded-lg transition-colors" onclick="showQRCode('${ticket.id}')">
                            Show QR
                        </button>
                    </div>
                ` : `
                    <div class="text-center py-2 text-gray-500 dark:text-gray-400">
                        Trip completed
                    </div>
                `}
            `;
            
            return card;
        }

        function updateTicketStats(tickets) {
            const activeCount = tickets.filter(t => t.status === 'active').length;
            const usedCount = tickets.filter(t => t.status === 'used').length;
            
            document.getElementById('activeTicketsCount').textContent = activeCount;
            document.getElementById('usedTicketsCount').textContent = usedCount;
            document.getElementById('totalTicketsCount').textContent = tickets.length;
        }

        function filterTickets(filter) {
            const tickets = appState.userTickets;
            let filteredTickets = tickets;
            
            if (filter === 'active') {
                filteredTickets = tickets.filter(t => t.status === 'active');
            } else if (filter === 'used') {
                filteredTickets = tickets.filter(t => t.status === 'used');
            }
            
            const ticketsList = document.getElementById('ticketsList');
            ticketsList.innerHTML = '';
            
            filteredTickets.forEach(ticket => {
                const ticketCard = createTicketCard(ticket);
                ticketsList.appendChild(ticketCard);
            });
        }

        function trackTicket(ticketId) {
            showAlert(`Tracking bus for ticket ${ticketId}. You'll be redirected to the live tracking screen.`);
        }

        function showQRCode(ticketId) {
            const ticket = appState.userTickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <div class="text-center">
                        <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-4">Boarding Pass</h3>
                        <div class="text-sm text-gray-600 dark:text-gray-400 mb-4">${ticket.id}</div>
                        
                        <div class="w-48 h-48 bg-gray-100 dark:bg-gray-700 mx-auto mb-4 rounded-lg flex items-center justify-center">
                            <div class="grid grid-cols-16 gap-1">
                                ${Array.from({length: 256}, () => 
                                    `<div class="w-2 h-2 ${Math.random() > 0.5 ? 'bg-gray-900 dark:bg-white' : 'bg-white dark:bg-gray-700'}"></div>`
                                ).join('')}
                            </div>
                        </div>
                        
                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-6">Show this QR code to the driver when boarding</p>
                        
                        <button class="px-6 py-2 bg-primary text-white hover:bg-blue-700 rounded-lg" onclick="this.closest('.fixed').remove()">Close</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Maps functionality
        function populateActiveRoutes() {
            const activeRoutes = [
                { name: 'Victoria Island ‚Üí Ikeja', buses: 12, avgTime: '45 min' },
                { name: 'Surulere ‚Üí Lekki', buses: 8, avgTime: '52 min' },
                { name: 'Yaba ‚Üí Ikoyi', buses: 6, avgTime: '38 min' },
                { name: 'Ketu ‚Üí Marina', buses: 15, avgTime: '65 min' }
            ];
            
            const container = document.getElementById('activeRoutesList');
            container.innerHTML = '';
            
            activeRoutes.forEach(route => {
                const routeCard = document.createElement('div');
                routeCard.className = 'glassmorphism rounded-2xl p-4';
                routeCard.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div>
                            <div class="font-semibold text-gray-900 dark:text-white">${route.name}</div>
                            <div class="text-sm text-gray-600 dark:text-gray-400">${route.buses} buses ‚Ä¢ ${route.avgTime}</div>
                        </div>
                        <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                    </div>
                `;
                container.appendChild(routeCard);
            });
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Welcome screen
            document.getElementById('getStartedBtn').addEventListener('click', showAuthScreen);
            
            // Auth screen
            document.getElementById('signInTab').addEventListener('click', function() {
                document.getElementById('signInTab').className = 'flex-1 py-2 px-4 rounded-xl text-sm font-semibold transition-all bg-white dark:bg-gray-600 text-primary shadow-sm';
                document.getElementById('signUpTab').className = 'flex-1 py-2 px-4 rounded-xl text-sm font-semibold transition-all text-gray-600 dark:text-gray-400';
                document.getElementById('authSubmitBtn').textContent = 'Sign In';
                document.getElementById('nameField').classList.add('hidden');
                document.getElementById('phoneField').classList.add('hidden');
                document.getElementById('confirmPasswordField').classList.add('hidden');
            });
            
            document.getElementById('signUpTab').addEventListener('click', function() {
                document.getElementById('signUpTab').className = 'flex-1 py-2 px-4 rounded-xl text-sm font-semibold transition-all bg-white dark:bg-gray-600 text-primary shadow-sm';
                document.getElementById('signInTab').className = 'flex-1 py-2 px-4 rounded-xl text-sm font-semibold transition-all text-gray-600 dark:text-gray-400';
                document.getElementById('authSubmitBtn').textContent = 'Sign Up';
                document.getElementById('nameField').classList.remove('hidden');
                document.getElementById('phoneField').classList.remove('hidden');
                document.getElementById('confirmPasswordField').classList.remove('hidden');
            });
            
            document.getElementById('googleSignIn').addEventListener('click', handleGoogleSignIn);
            
            document.getElementById('authForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const isSignUp = document.getElementById('authSubmitBtn').textContent === 'Sign Up';
                handleEmailAuth(isSignUp);
            });
            
            // Profile menu
            document.getElementById('profileMenuBtn').addEventListener('click', function() {
                const menu = document.getElementById('profileMenu');
                menu.classList.toggle('hidden');
            });
            
            // Close profile menu when clicking outside
            document.addEventListener('click', function(e) {
                const menu = document.getElementById('profileMenu');
                const btn = document.getElementById('profileMenuBtn');
                if (!menu.contains(e.target) && !btn.contains(e.target)) {
                    menu.classList.add('hidden');
                }
            });
            
            // Profile menu actions
            document.querySelectorAll('.profile-menu-item').forEach(item => {
                item.addEventListener('click', function() {
                    const action = this.dataset.action;
                    document.getElementById('profileMenu').classList.add('hidden');
                    
                    switch(action) {
                        case 'viewProfile':
                            showScreen('profileScreen');
                            break;
                        case 'myTickets':
                            showScreen('ticketsScreen');
                            break;
                        case 'tripHistory':
                            showAlert('Trip history feature coming soon!');
                            break;
                        case 'preferences':
                            showScreen('profileScreen');
                            break;
                        case 'signOut':
                            showConfirmDialog('Are you sure you want to sign out?', () => signOut());
                            break;
                    }
                });
            });
            
            // Bottom navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    const screen = this.dataset.screen;
                    switch(screen) {
                        case 'home':
                            showScreen('homeScreen');
                            break;
                        case 'maps':
                            showScreen('mapsScreen');
                            populateActiveRoutes();
                            break;
                        case 'tickets':
                            showScreen('ticketsScreen');
                            loadUserTickets();
                            break;
                        case 'profile':
                            showScreen('profileScreen');
                            break;
                    }
                });
            });
            
            // Ticket filters
            document.querySelectorAll('.ticket-filter').forEach(filter => {
                filter.addEventListener('click', function() {
                    document.querySelectorAll('.ticket-filter').forEach(f => {
                        f.className = 'ticket-filter flex-1 py-2 px-4 rounded-xl text-sm font-semibold transition-all text-gray-600 dark:text-gray-400';
                    });
                    this.className = 'ticket-filter flex-1 py-2 px-4 rounded-xl text-sm font-semibold transition-all bg-white dark:bg-gray-600 text-primary shadow-sm';
                    
                    filterTickets(this.dataset.filter);
                });
            });
            
            // Google Maps integration
            document.getElementById('openGoogleMaps').addEventListener('click', function() {
                const url = 'https://maps.google.com/?q=Lagos,Nigeria';
                window.open(url, '_blank');
            });
            
            // Route planning
            document.getElementById('findRoutesBtn').addEventListener('click', function() {
                const from = document.getElementById('fromLocation').value.trim();
                const to = document.getElementById('toLocation').value.trim();
                
                if (!from || !to) {
                    showAlert('Please enter both pickup and destination locations');
                    return;
                }
                
                showAlert(`Finding routes from ${from} to ${to}. Route booking feature coming soon!`);
            });
            
            document.getElementById('swapLocations').addEventListener('click', function() {
                const from = document.getElementById('fromLocation').value;
                const to = document.getElementById('toLocation').value;
                document.getElementById('fromLocation').value = to;
                document.getElementById('toLocation').value = from;
            });
            
            // Popular routes
            document.querySelectorAll('.popular-route').forEach(route => {
                route.addEventListener('click', function() {
                    document.getElementById('fromLocation').value = this.dataset.from;
                    document.getElementById('toLocation').value = this.dataset.to;
                });
            });
            
            // Initialize app
            showWelcomeScreen();
        });
    </script>
<div id="paymentModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 hidden">
  <div class="bg-white dark:bg-gray-900 rounded-2xl shadow-xl max-w-md w-full p-8">
    <h2 class="text-xl font-bold mb-4 text-gray-900 dark:text-white">Secure Payment</h2>
    <form id="paymentForm" class="space-y-4">
      <div>
        <label class="block text-sm mb-1">Card Number</label>
        <input type="text" required maxlength="19" class="w-full px-3 py-2 border rounded-lg" placeholder="1234 5678 9012 3456">
      </div>
      <div class="flex space-x-2">
        <div>
          <label class="block text-sm mb-1">Expiry</label>
          <input type="text" required maxlength="5" class="w-full px-3 py-2 border rounded-lg" placeholder="MM/YY">
        </div>
        <div>
          <label class="block text-sm mb-1">CVV</label>
          <input type="text" required maxlength="4" class="w-full px-3 py-2 border rounded-lg" placeholder="123">
        </div>
      </div>
      <div>
        <label class="block text-sm mb-1">Cardholder Name</label>
        <input type="text" required class="w-full px-3 py-2 border rounded-lg" placeholder="Full Name">
      </div>
      <div class="flex space-x-2">
        <button type="submit" class="flex-1 bg-primary text-white py-2 rounded-lg">Pay Now</button>
        <button type="button" class="flex-1 bg-gray-200 text-gray-700 py-2 rounded-lg" onclick="closePaymentModal()">Cancel</button>
      </div>
    </form>
    <div class="flex space-x-3 mt-4">
      <img src="https://img.icons8.com/color/48/000000/visa.png" class="h-8" alt="Visa"/>
      <img src="https://img.icons8.com/color/48/000000/mastercard-logo.png" class="h-8" alt="Mastercard"/>
      <img src="https://img.icons8.com/color/48/000000/verve-card.png" class="h-8" alt="Verve"/>
    </div>
  </div>
</div>
</body>
</html>
